<!-- src/app/usuarios/usuarios.component.html -->
<app-navbar></app-navbar>
<app-sidebar></app-sidebar>
<div class="content-wrapper">
    <section class="content">
      
        <section class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1>Usuarios</h1>
              </div>
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                  <!-- Breadcrumb content -->
                </ol>
              </div>
            </div>
          </div>
        </section>
        
        <!-- Default box -->
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Usuarios</h3>
            <button class="btn btn-primary float-right" (click)="nuevoUsuario()">Nuevo Usuario</button>
          </div>
          <div class="card-body">
            <table class="table table-bordered table-hover">
              <thead>
                <tr>
                  <th>ID Usuario</th>
                  <th>Username</th>
                  <th>Nombre</th>
                  <th>Rol</th>
                  <th>Estado</th>
                  <th>Dominio</th>
                  <th>Fecha y Hora de Creaci√≥n</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let usuario of usuarios">
                  <td>{{usuario.id_usuario}}</td>
                  <td>{{usuario.username}}</td>
                  <td>{{usuario.nombre_persona}}</td>
                  <td>{{usuario.id_rol}}</td>
                  <td>{{usuario.estado}}</td>
                  <td>{{usuario.id_dominio}}</td>
                  <td>{{usuario.fecha_hora_creacion}}</td>
                  <td>
                    <button class="btn btn-primary" (click)="editarUsuario(usuario)">Editar</button>
                    <button class="btn btn-danger" (click)="eliminarUsuario(usuario.id_usuario)">Eliminar</button>
                    <button class="btn btn-outline-dark" (click)="resetPassUsuario(usuario.id_usuario)">ResetPass</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- /.card-body -->
          <div class="card-footer">
            Geolytic Vises
          </div>
          <!-- /.card-footer-->
        </div>
        <!-- /.card -->
    </section>
    <!-- /.content -->
</div>

<!-- Modal para Crear/Editar Usuario -->
<div class="modal" [ngClass]="{'show': showModal}" tabindex="-1" [style.display]="showModal ? 'block' : 'none'">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="usuarioModalLabel">{{accion}} Usuario</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="showModal = false">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="card">
          <div class="card-body">
            <form id="usuarioForm" [formGroup]="form" (ngSubmit)="accion_form()">
              <div class="mb-3">
                <label class="form-label">Username</label>
                <input type="text" class="form-control" formControlName="username" required/>
              </div>
              <!-- <div class="mb-3">
                <label class="form-label">Password</label>
                <input type="password" class="form-control" formControlName="password" required/>
              </div> -->
              <div class="mb-3">
                <label class="form-label">Nombre</label>
                <input type="text" class="form-control" formControlName="nombre_persona" required/>
              </div>
              <div class="mb-3">
                <label class="form-label">Email</label>
                <input type="text" class="form-control" formControlName="email" required/>
              </div>
              <div class="mb-3">
                <label class="form-label">Rol</label>
                <select class="form-control" formControlName="id_rol" required>
                  <option *ngFor="let rol of roles" [value]="rol.id_rol">{{rol.descripcion}}</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Estado</label>
                <input type="text" class="form-control" formControlName="estado" required/>
              </div>
              <div class="mb-3">
                <label class="form-label">Dominio</label>
                <input type="number" class="form-control" formControlName="id_dominio" required/>
              </div>
              <div class="row">
                <div class="col-4">
                  <button type="submit" [disabled]="form.invalid" class="btn btn-primary">Guardar</button>
                </div>
                <!-- /.col -->
              </div>
              <div class="mb-3">
                <input type="hidden" formControlName="id_usuario" />
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<app-footer></app-footer>
